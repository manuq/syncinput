!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).SyncInput={})}(this,function(t){"use strict";function e(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[];for(var t=navigator.getGamepads(),e=0;e<t.length;e++)if(null!==t[e]){this.setGamepad(t[e]);break}if(null===this.gamepad)throw new Error("No gamepad found")}function s(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function i(){this.keys=[],this.actions=[];var e=this,s=this.actions;this.events.push([window,"keydown",function(t){s.push(t.keyCode),s.push(Key.DOWN)}]),this.events.push([window,"keyup",function(t){s.push(t.keyCode),s.push(Key.UP)}]),this.events.push([window,"focus",function(t){e.reset()}]),this.create()}function o(){this._keys=[],this._position=new Vector2(0,0),this._positionUpdated=!1,this._delta=new Vector2(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=!1,this.keys=new Array(5),this.position=new THREE.Vector2(0,0),this.delta=new THREE.Vector2(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.canvas=null,this.events=[];for(var t=0;t<3;t++)this._doubleClicked[t]=!1,this.doubleClicked[t]=!1,this._keys[t]=new Key,this.keys[t]=new Key;var i,n=this;void 0!==window.onmousewheel?this.events.push([window,"mousewheel",function(t){n._wheel=t.deltaY,n._wheelUpdated=!0}]):void 0!==window.addEventListener?this.events.push([window,"DOMMouseScroll",function(t){n._wheel=30*t.detail,n._wheelUpdated=!0}]):this.events.push([window,"wheel",function(t){n._wheel=t.deltaY,n._wheelUpdated=!0}]),"ontouchstart"in window||0<navigator.msMaxTouchPoints?(i=new Vector2(0,0),this.events.push([window,"touchstart",function(t){var e=t.touches[0];i.set(e.clientX,e.clientY),n.updateKey(o.LEFT,Key.DOWN)}]),this.events.push([window,"touchend",function(t){n.updateKey(o.LEFT,Key.UP)}]),this.events.push([window,"touchcancel",function(t){n.updateKey(o.LEFT,Key.UP)}]),this.events.push([window,"touchmove",function(t){var e,s=t.touches[0];null!==n.canvas?(e=n.canvas.getBoundingClientRect(),n.updatePosition(s.clientX-e.left,s.clientY-e.top,s.clientX-i.x,s.clientY-i.y)):n.updatePosition(s.clientX,s.clientY,s.clientX-i.x,s.clientY-i.y),i.set(s.clientX,s.clientY)}])):(this.events.push([window,"mousemove",function(t){var e;null!==n.canvas?(e=n.canvas.getBoundingClientRect(),n.updatePosition(t.clientX-e.left,t.clientY-e.top,t.movementX,t.movementY)):n.updatePosition(t.clientX,t.clientY,t.movementX,t.movementY)}]),this.events.push([window,"mousedown",function(t){n.updateKey(t.which-1,Key.DOWN)}]),this.events.push([window,"mouseup",function(t){n.updateKey(t.which-1,Key.UP)}])),this.events.push([window,"dblclick",function(t){n._doubleClicked[t.which-1]=!0}]);for(t=0;t<this.events.length;t++){var e=this.events[t];e[0].addEventListener(e[1],e[2])}}function n(t,e){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0}e.prototype.setGamepad=function(t){if(null!=t){this.index=t.index,this.gamepad=t,this.buttons=[];for(var e=0;e<t.buttons.length;e++)this.buttons.push(new Key);this.setProductVendor(t),this.connected=!0}else console.warn("nunuStudio: No gamepad found"),this.disconnect()},e.prototype.disconnect=function(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[]},e.prototype.setProductVendor=function(t){try{var e=t.id.split(":");return this.vendor=e[1].split(" ")[1],void(this.product=e[2].replace(" ","").replace(")",""))}catch(t){}try{e=t.id.split("-");return this.vendor=e[0],void(this.product=e[1])}catch(t){}},e.prototype.update=function(t){if(this.gamepad=navigator.getGamepads()[this.index],void 0!==this.gamepad)for(var e=0;e<this.buttons.length;e++)this.buttons[e].update(this.gamepad.buttons[e].pressed?Key.DOWN:Key.UP)},e.prototype.getAnalogueButton=function(t){return t>this.buttons.length||t<0?0:this.gamepad.buttons[t].value},e.prototype.getAxis=function(t){return t>this.gamepad.axes.length||t<0?0:this.gamepad.axes[t]},e.prototype.buttonExists=function(t){return 0<=t&&t<this.buttons.length},e.prototype.buttonPressed=function(t){return!!this.buttons[t]&&this.buttons[t].pressed},e.prototype.buttonJustPressed=function(t){return!!this.buttons[t]&&this.buttons[t].justPressed},e.prototype.buttonJustReleased=function(t){return!!this.buttons[t]&&this.buttons[t].justReleased},e.LEFT=14,e.RIGHT=15,e.DOWN=13,e.UP=12,e.SELECT=8,e.START=9,e.HOME=16,e.LEFT_TRIGGER_A=4,e.LEFT_TRIGGER_B=6,e.RIGHT_TRIGGER_A=5,e.RIGHT_TRIGGER_B=7,e.L1=4,e.L2=6,e.L3=6,e.R1=5,e.R2=7,e.R3=11,e.A=0,e.B=1,e.C=2,e.D=3,e.X=2,e.Y=3,e.LEFT_ANALOGUE_BUT=10,e.LEFT_ANALOGUE_HOR=0,e.LEFT_ANALOGUE_VERT=1,e.RIGHT_ANALOGUE_BUT=11,e.RIGHT_ANALOGUE_HOR=2,e.RIGHT_ANALOGUE_VERT=3,s.DOWN=-1,s.UP=1,s.RESET=0,(s.prototype.constructor=s).prototype.update=function(t){this.justPressed=!1,this.justReleased=!1,t===s.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):t===s.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):t===s.RESET&&(this.justReleased=!1,this.justPressed=!1)},s.prototype.set=function(t,e,s){this.justPressed=t,this.pressed=e,this.justReleased=s},s.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},((i.prototype=i).constructor=i).update=function(){for(var t=0;this.actions.length>t;){var e=this.actions.shift(),s=this.actions.shift();void 0===this.keys[e]&&(this.keys[e]=new Key),this.keys[e].update(s),(this.keys[e].justReleased||this.keys[e].justPressed)&&(this.actions.push(e),this.actions.push(Key.RESET),t+=2)}},i.reset=function(){for(var t=0;t<this.keys.length;t++)void 0!==this.keys[t]&&this.keys[t].reset()},i.keyPressed=function(t){return void 0!==this.keys[t]&&this.keys[t].pressed},i.keyJustPressed=function(t){return void 0!==this.keys[t]&&this.keys[t].justPressed},i.keyJustReleased=function(t){return void 0!==this.keys[t]&&this.keys[t].justReleased},i.create=function(){this.events.create()},i.dispose=function(){this.events.destroy()},i.TAB=9,i.ENTER=13,i.SHIFT=16,i.CTRL=17,i.ALT=18,i.CAPS_LOCK=20,i.ESC=27,i.SPACEBAR=32,i.PAGE_UP=33,i.PAGE_DOWN=34,i.END=35,i.HOME=36,i.INSERT=45,i.DEL=46,i.LEFT=37,i.RIGHT=39,i.UP=38,i.DOWN=40,i.NUM0=48,i.NUM1=49,i.NUM2=50,i.NUM3=51,i.NUM4=52,i.NUM5=53,i.NUM6=54,i.NUM7=55,i.NUM8=56,i.NUM9=57,i.A=65,i.B=66,i.C=67,i.D=68,i.E=69,i.F=70,i.G=71,i.H=72,i.I=73,i.J=74,i.K=75,i.L=76,i.M=77,i.N=78,i.O=79,i.P=80,i.Q=81,i.R=82,i.S=83,i.T=84,i.U=85,i.V=86,i.W=87,i.X=88,i.Y=89,i.Z=90,i.F1=112,i.F2=113,i.F3=114,i.F4=115,i.F5=116,i.F6=117,i.F7=118,i.F8=119,i.F9=120,i.F10=121,i.F11=122,i.F12=123,((o.prototype=o).constructor=o).LEFT=0,o.MIDDLE=1,o.RIGHT=2,o.BACK=3,o.FORWARD=4,o.prototype.setCanvas=function(t){(this.canvas=t).mouseInside=!1,t.addEventListener("mouseenter",function(){this.mouseInside=!0}),t.addEventListener("mouseleave",function(){this.mouseInside=!1})},o.prototype.insideCanvas=function(){return null!==this.canvas&&this.canvas.mouseInside},o.prototype.setLock=function(t){null!==this.canvas&&(t?(this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock||this.canvas.webkitRequestPointerLock,void 0!==this.canvas.requestPointerLock&&this.canvas.requestPointerLock()):void 0!==document.exitPointerLock?document.exitPointerLock():void 0!==document.mozExitPointerLock?document.mozExitPointerLock():void 0!==document.webkitExitPointerLock&&document.webkitExitPointerLock())},o.prototype.buttonPressed=function(t){return this.keys[t].pressed},o.prototype.buttonDoubleClicked=function(){return this.doubleClicked},o.prototype.buttonJustPressed=function(t){return this.keys[t].justPressed},o.prototype.buttonJustReleased=function(t){return this.keys[t].justReleased},o.prototype.updatePosition=function(t,e,s,i){this._position.set(t,e),this._delta.x+=s,this._delta.y+=i,this._positionUpdated=!0},o.prototype.updateKey=function(t,e){-1<t&&this._keys[t].update(e)},o.prototype.update=function(){for(var t=0;t<this._keys.length;t++)this._keys[t].justPressed&&this.keys[t].justPressed&&(this._keys[t].justPressed=!1),this._keys[t].justReleased&&this.keys[t].justReleased&&(this._keys[t].justReleased=!1),this.keys[t].set(this._keys[t].justPressed,this._keys[t].pressed,this._keys[t].justReleased);this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._doubleClicked?(this.doubleClicked=!0,this._doubleClicked=!1):this.doubleClicked=!1,this._positionUpdated?(this.delta.x=this._delta.x,this.delta.y=this._delta.y,this._delta.set(0,0),this.position.x=this._position.x,this.position.y=this._position.y,this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},o.prototype.dispose=function(){for(var t=0;t<this.events.length;t++){var e=this.events[t];e[0].removeEventListener(e[1],e[2])}},n.prototype.set=function(t,e){this.x=t,this.y=e};t.Gamepad=e,t.Key=s,t.Keyboard=i,t.Mouse=o,t.VERSION="V1.2",t.Vector2=n,Object.defineProperty(t,"__esModule",{value:!0})});