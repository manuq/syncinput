!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).SyncInput={})}(this,function(t){"use strict";function n(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function e(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[];for(var t=navigator.getGamepads(),e=0;e<t.length;e++)if(null!==t[e]){this.setGamepad(t[e]);break}null===this.gamepad&&console.error("No gamepad found")}function s(){this.keys=[],this.actions=[],this.events=[];var e=this,s=this.actions;this.events.push([window,"keydown",function(t){s.push(t.keyCode),s.push(n.DOWN)}]),this.events.push([window,"keyup",function(t){s.push(t.keyCode),s.push(n.UP)}]),this.events.push([window,"focus",function(t){e.reset()}]),this.create()}function o(t,e){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0}function h(){this._keys=[],this._position=new o(0,0),this._positionUpdated=!1,this._delta=new o(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new o(0,0),this.delta=new o(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.canvas=null,this.events=[];for(var t=0;t<3;t++)this._doubleClicked[t]=!1,this.doubleClicked[t]=!1,this._keys[t]=new n,this.keys[t]=new n;var s,i=this;void 0!==window.onmousewheel?this.events.push([window,"mousewheel",function(t){i._wheel=t.deltaY,i._wheelUpdated=!0}]):void 0!==window.addEventListener?this.events.push([window,"DOMMouseScroll",function(t){i._wheel=30*t.detail,i._wheelUpdated=!0}]):this.events.push([window,"wheel",function(t){i._wheel=t.deltaY,i._wheelUpdated=!0}]),"ontouchstart"in window||0<navigator.msMaxTouchPoints?(s=new o(0,0),this.events.push([window,"touchstart",function(t){t=t.touches[0];s.set(t.clientX,t.clientY),i.updateKey(h.LEFT,n.DOWN)}]),this.events.push([window,"touchend",function(t){i.updateKey(h.LEFT,n.UP)}]),this.events.push([window,"touchcancel",function(t){i.updateKey(h.LEFT,n.UP)}]),this.events.push([window,"touchmove",function(t){var e,t=t.touches[0];null!==i.canvas?(e=i.canvas.getBoundingClientRect(),i.updatePosition(t.clientX-e.left,t.clientY-e.top,t.clientX-s.x,t.clientY-s.y)):i.updatePosition(t.clientX,t.clientY,t.clientX-s.x,t.clientY-s.y),s.set(t.clientX,t.clientY)}])):(this.events.push([window,"mousemove",function(t){var e;null!==i.canvas?(e=i.canvas.getBoundingClientRect(),i.updatePosition(t.clientX-e.left,t.clientY-e.top,t.movementX,t.movementY)):i.updatePosition(t.clientX,t.clientY,t.movementX,t.movementY)}]),this.events.push([window,"mousedown",function(t){i.updateKey(t.which-1,n.DOWN)}]),this.events.push([window,"mouseup",function(t){i.updateKey(t.which-1,n.UP)}])),this.events.push([window,"dblclick",function(t){i._doubleClicked[t.which-1]=!0}]);for(t=0;t<this.events.length;t++){var e=this.events[t];e[0].addEventListener(e[1],e[2])}}n.DOWN=-1,n.UP=1,n.RESET=0,(n.prototype.constructor=n).prototype.update=function(t){this.justPressed=!1,this.justReleased=!1,t===n.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):t===n.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):t===n.RESET&&(this.justReleased=!1,this.justPressed=!1)},n.prototype.set=function(t,e,s){this.justPressed=t,this.pressed=e,this.justReleased=s},n.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},e.prototype.setGamepad=function(t){if(null!=t){this.index=t.index,this.gamepad=t,this.buttons=[];for(var e=0;e<t.buttons.length;e++)this.buttons.push(new n);this.setProductVendor(t),this.connected=!0}else console.warn("nunuStudio: No gamepad found"),this.disconnect()},e.prototype.disconnect=function(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[]},e.prototype.setProductVendor=function(t){try{var e=t.id.split(":");return this.vendor=e[1].split(" ")[1],void(this.product=e[2].replace(" ","").replace(")",""))}catch(t){}try{e=t.id.split("-");this.vendor=e[0],this.product=e[1]}catch(t){}},e.prototype.update=function(t){if(this.gamepad=navigator.getGamepads()[this.index],void 0!==this.gamepad)for(var e=0;e<this.buttons.length;e++)this.buttons[e].update(this.gamepad.buttons[e].pressed?n.DOWN:n.UP)},e.prototype.getAnalogueButton=function(t){return t>this.buttons.length||t<0?0:this.gamepad.buttons[t].value},e.prototype.getAxis=function(t){return t>this.gamepad.axes.length||t<0?0:this.gamepad.axes[t]},e.prototype.buttonExists=function(t){return 0<=t&&t<this.buttons.length},e.prototype.buttonPressed=function(t){return!!this.buttons[t]&&this.buttons[t].pressed},e.prototype.buttonJustPressed=function(t){return!!this.buttons[t]&&this.buttons[t].justPressed},e.prototype.buttonJustReleased=function(t){return!!this.buttons[t]&&this.buttons[t].justReleased},e.LEFT=14,e.RIGHT=15,e.DOWN=13,e.UP=12,e.SELECT=8,e.START=9,e.HOME=16,e.LEFT_TRIGGER_A=4,e.LEFT_TRIGGER_B=6,e.RIGHT_TRIGGER_A=5,e.RIGHT_TRIGGER_B=7,e.L1=4,e.L2=6,e.L3=6,e.R1=5,e.R2=7,e.R3=11,e.A=0,e.B=1,e.C=2,e.D=3,e.X=2,e.Y=3,e.LEFT_ANALOGUE_BUT=10,e.LEFT_ANALOGUE_HOR=0,e.LEFT_ANALOGUE_VERT=1,e.RIGHT_ANALOGUE_BUT=11,e.RIGHT_ANALOGUE_HOR=2,e.RIGHT_ANALOGUE_VERT=3,((s.prototype=s).constructor=s).update=function(){for(var t=0;this.actions.length>t;){var e=this.actions.shift(),s=this.actions.shift();void 0===this.keys[e]&&(this.keys[e]=new n),this.keys[e].update(s),(this.keys[e].justReleased||this.keys[e].justPressed)&&(this.actions.push(e),this.actions.push(n.RESET),t+=2)}},s.reset=function(){for(var t=0;t<this.keys.length;t++)void 0!==this.keys[t]&&this.keys[t].reset()},s.keyPressed=function(t){return void 0!==this.keys[t]&&this.keys[t].pressed},s.keyJustPressed=function(t){return void 0!==this.keys[t]&&this.keys[t].justPressed},s.keyJustReleased=function(t){return void 0!==this.keys[t]&&this.keys[t].justReleased},s.create=function(){for(var t=0;t<this.events.length;t++){var e=this.events[t];e[0].addEventListener(e[1],e[2])}},s.dispose=function(){for(var t=0;t<this.events.length;t++){var e=this.events[t];e[0].removeEventListener(e[1],e[2])}},s.TAB=9,s.ENTER=13,s.SHIFT=16,s.CTRL=17,s.ALT=18,s.CAPS_LOCK=20,s.ESC=27,s.SPACEBAR=32,s.PAGE_UP=33,s.PAGE_DOWN=34,s.END=35,s.HOME=36,s.INSERT=45,s.DEL=46,s.LEFT=37,s.RIGHT=39,s.UP=38,s.DOWN=40,s.NUM0=48,s.NUM1=49,s.NUM2=50,s.NUM3=51,s.NUM4=52,s.NUM5=53,s.NUM6=54,s.NUM7=55,s.NUM8=56,s.NUM9=57,s.A=65,s.B=66,s.C=67,s.D=68,s.E=69,s.F=70,s.G=71,s.H=72,s.I=73,s.J=74,s.K=75,s.L=76,s.M=77,s.N=78,s.O=79,s.P=80,s.Q=81,s.R=82,s.S=83,s.T=84,s.U=85,s.V=86,s.W=87,s.X=88,s.Y=89,s.Z=90,s.F1=112,s.F2=113,s.F3=114,s.F4=115,s.F5=116,s.F6=117,s.F7=118,s.F8=119,s.F9=120,s.F10=121,s.F11=122,s.F12=123,o.prototype.set=function(t,e){this.x=t,this.y=e},((h.prototype=h).constructor=h).LEFT=0,h.MIDDLE=1,h.RIGHT=2,h.BACK=3,h.FORWARD=4,h.prototype.setCanvas=function(t){(this.canvas=t).mouseInside=!1,t.addEventListener("mouseenter",function(){this.mouseInside=!0}),t.addEventListener("mouseleave",function(){this.mouseInside=!1})},h.prototype.insideCanvas=function(){return null!==this.canvas&&this.canvas.mouseInside},h.prototype.setLock=function(t){null!==this.canvas&&(t?(this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock||this.canvas.webkitRequestPointerLock,void 0!==this.canvas.requestPointerLock&&this.canvas.requestPointerLock()):void 0!==document.exitPointerLock?document.exitPointerLock():void 0!==document.mozExitPointerLock?document.mozExitPointerLock():void 0!==document.webkitExitPointerLock&&document.webkitExitPointerLock())},h.prototype.buttonPressed=function(t){return this.keys[t].pressed},h.prototype.buttonDoubleClicked=function(){return this.doubleClicked},h.prototype.buttonJustPressed=function(t){return this.keys[t].justPressed},h.prototype.buttonJustReleased=function(t){return this.keys[t].justReleased},h.prototype.updatePosition=function(t,e,s,i){this._position.set(t,e),this._delta.x+=s,this._delta.y+=i,this._positionUpdated=!0},h.prototype.updateKey=function(t,e){-1<t&&this._keys[t].update(e)},h.prototype.update=function(){for(var t=0;t<this._keys.length;t++)this._keys[t].justPressed&&this.keys[t].justPressed&&(this._keys[t].justPressed=!1),this._keys[t].justReleased&&this.keys[t].justReleased&&(this._keys[t].justReleased=!1),this.keys[t].set(this._keys[t].justPressed,this._keys[t].pressed,this._keys[t].justReleased);this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._doubleClicked?(this.doubleClicked=!0,this._doubleClicked=!1):this.doubleClicked=!1,this._positionUpdated?(this.delta.x=this._delta.x,this.delta.y=this._delta.y,this._delta.set(0,0),this.position.x=this._position.x,this.position.y=this._position.y,this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},h.prototype.dispose=function(){for(var t=0;t<this.events.length;t++){var e=this.events[t];e[0].removeEventListener(e[1],e[2])}};t.Gamepad=e,t.Key=n,t.Keyboard=s,t.Mouse=h,t.VERSION="V1.2",t.Vector2=o,Object.defineProperty(t,"__esModule",{value:!0})});